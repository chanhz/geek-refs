## 起因
Golang 在 1.10 以上的版本，使用 MySQL 作为数据库时，程序写入时出现这样的错误，broken pipe
原因是尝试使用了关闭的连接的连接发起写请求。


Go 1.11 版本后，必须显示设置 SetConnMaxLifetime ，否则连接将不会被回收，导致程序使用过期的连接而引发错误。


## 解决过程：
使用 show processlist,查看数据库连接，发现使用 go 1.12  的应用的连接生命最长超过 6 小时，go 1.10 的应用连接生命都只有 5 秒以下。
而数据库默认空闲连接的生命周期通常是 8 小时，我应用已经设置为 4 小时了，为什么数据库超过 4 小时的连接没有被 go 关闭呢？

难道清理了但是没关闭吗？

参考 https://github.com/go-sql-driver/mysql/issues/657 后发现，对于 1.11 前的版本，golang 将空闲连接数默认设置为 2，参考此操作后，暂时没有再出现过类似问题。 